<!DOCTYPE html>
<html lang="zh-Hans">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>大一上总结 - Zecong Hu&#39;s blog</title>
  <meta name="description" content="从去年8月底进入大学，到今年1月底结束在大学的第一个学期，半年时间转瞬即逝。大学带给我了一种全新的、我从未体验过的经历，也多多少少给我带来了一些改变。谨以此文总结我大学生活的第一个半年。 本来写了挺长的流水账，想了想，删掉了一大半。">

  
  <link rel="stylesheet" href="/assets/styles/core.css?v=20191121014911">
  <link rel="stylesheet" href="/assets/styles/fontello.css?v=20191121014911">
  <link rel="stylesheet" href="/assets/styles/highlighting/default.css?v=20191121014911">

  <link rel="canonical" href="http://zecong.hu/2015/02/06/my-1st-semester-in-college/">
  <link rel="alternate" type="application/rss+xml" title="Zecong Hu&#39;s blog" href="/feed.xml">

  <link rel="apple-touch-icon" sizes="57x57" href="/assets/favicon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/favicon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/favicon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/favicon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/favicon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/favicon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/favicon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/favicon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/favicon/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="/assets/favicon/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/favicon/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://unpkg.com/tippy.js@4/themes/light.css">
  <script src="https://unpkg.com/popper.js@1/dist/umd/popper.min.js"></script>
  <script src="https://unpkg.com/tippy.js@4/umd/index.all.min.js"></script>
  

  

  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48327586-2', 'auto');
  ga('send', 'pageview');

</script>
  

  
</head>

  <body>

  <main class="page-content" aria-label="Content">
    
    <div id="table-of-contents">
      <div class="toc-wrapper">
        <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#班级和同学们">班级和同学们</a></li>
<li class="toc-entry toc-h2"><a href="#军训">军训</a></li>
<li class="toc-entry toc-h2"><a href="#辩论赛">辩论赛</a></li>
<li class="toc-entry toc-h2"><a href="#学生节">学生节</a></li>
<li class="toc-entry toc-h2"><a href="#小教员">小教员</a></li>
<li class="toc-entry toc-h2"><a href="#学习方面">学习方面</a>
<ul>
<li class="toc-entry toc-h3"><a href="#微积分">微积分</a></li>
<li class="toc-entry toc-h3"><a href="#线性代数">线性代数</a></li>
<li class="toc-entry toc-h3"><a href="#离散数学">离散数学</a></li>
<li class="toc-entry toc-h3"><a href="#程序设计基础">程序设计基础</a></li>
<li class="toc-entry toc-h3"><a href="#计算机科学导论">计算机科学导论</a></li>
<li class="toc-entry toc-h3"><a href="#信息科学技术概论">信息科学技术概论</a></li>
<li class="toc-entry toc-h3"><a href="#思想道德修养与法律基础">思想道德修养与法律基础</a></li>
<li class="toc-entry toc-h3"><a href="#计算科学与生涯规划">计算科学与生涯规划</a></li>
<li class="toc-entry toc-h3"><a href="#社会心理探索">社会心理探索</a></li>
<li class="toc-entry toc-h3"><a href="#德语第二外国语1">德语(第二外国语)(1)</a></li>
<li class="toc-entry toc-h3"><a href="#学术英语读写3文献综述">学术英语读写（3）——文献综述</a></li>
<li class="toc-entry toc-h3"><a href="#学术英语听说4辩论">学术英语听说（4）——辩论</a></li>
<li class="toc-entry toc-h3"><a href="#实验室科研探究">实验室科研探究</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#后记">后记</a></li>
<li class="toc-entry toc-h2"><a href="#展望">展望</a></li>
</ul>
      </div>
    </div>
    

    <div class="wrapper">
      <nav class="site-nav">
  
  
  	
  	<a class="page-link" href="/" >About</a>
  	
  
  	
  	<a class="page-link" href="/index/en/index.html" >Articles</a>
  	
  
  	
  	<a class="page-link" href="/index/cn/index.html" >文章列表</a>
  	
  
  	
  
  	
  
</nav>



<article class="post" lang="zh-Hans" itemscope itemtype="http://schema.org/BlogPosting" >

  <header class="post-header">
  <a class="site-title" href="/">
  	
      Zecong Hu&#39;s blog
    
  </a>
  <h1 class="post-title" itemprop="name headline">大一上总结</h1>
</header>




  <div class="post-content" itemprop="articleBody">
    <p>从去年8月底进入大学，到今年1月底结束在大学的第一个学期，半年时间转瞬即逝。大学带给我了一种全新的、我从未体验过的经历，也多多少少给我带来了一些改变。谨以此文总结我大学生活的第一个半年。</p>

<p>本来写了挺长的流水账，想了想，删掉了一大半。</p>

<!--more-->

<h2 id="班级和同学们">班级和同学们</h2>

<p>我非常喜欢我现在的班级。高中由于竞赛而在两个班呆过，这两个班的人员也在不停地改变，加之我在班上的时间也少，班级活动经常与竞赛冲突，因此基本上没有归属感。现在的班级让我很有归属感，让我感到我确实在班中有一席之位。班上的同学们也很团结，毕竟，我们班的口号之一就是 Unity is Power（Strength）。</p>

<p>由于姚班二招的关系，我的室友也有过一次变化。最开始在一个寝室的有徐子南、李文正和左世良，后来后面两人去了姚班，给我们安排的新室友是2班的杨天龙和黄越钦。我们这种同寝不同班的寝室在年级应该也是比较少的。不过也有这样的好处，也可以了解一下他们班的情况，总之就是信息量比较大吧。</p>

<p>班上一共4位女生，男女比是6.5:1，是全年级最低的（因为别的班去姚班的少= =），据说是这几届里最低的。嘛，毕竟贵系嘛。保送狗一共6只，有竞赛基础的还有不少。很多同学都很有来历，百度一下你就知道。</p>

<p>苏克、徐子南、韦毅龙、黄豪硕和我一起成立了个<del>鬼畜组</del>友好的同学小群，这几位也大概是我在班上玩得最好几位吧。</p>

<h2 id="军训">军训</h2>

<p>来到清华的第一件事就是军训。过去经历过的最长的军训也不过一周，这次一训就是三周。前几天还好，一周的训练下来，再加上一次凌晨出发徒步行走 18km 的拉练，我就有点招架不住了。倒不是身体撑不住，而是精神上没有动力。之后的每一天都盼着军训以外的活动，和训练间的休息。好在越到后面训练也就越轻松。</p>

<p>在为期19天的军训结束之时，我真是松了一口气。不过现在想想，那19天也算是强行锻炼身体吧。</p>

<h2 id="辩论赛">辩论赛</h2>

<p>这应该是在大学参加的第一个活动吧，而且持续时间特别长，从第5周开始，到第12周才结束。我们班从小组赛出线，打过半决赛，最后在决赛中败给对手拿到亚军。</p>

<p>我是因为上了英语听说4才被半劝半拉进辩论队的。刚开始还不太愿意，但后来想着应该会有意思，而且可以在一定程度上锻炼自己，就参加了。其实我自己的辩论能力很差，语言表达能力也不算好，有时候会反应不过来。我参加了前两场比赛，都是当的一辩，整场辩论下来除了念稿子之外基本上就说几句话。</p>

<p>虽说基本上是在打酱油，辩论还是很好玩的。准备时和大家一起在408中厅撕逼，还认识了知识水平巨高的学长。不过由于持续时间长，中间也耽误了其他的事情，比如期中考试、线代机考。所幸两边都没有太糟糕。</p>

<h2 id="学生节">学生节</h2>

<p>这又是本学期的一个耗时间的大坑。学生节的准备工作应该是从大概第8周开始的，一直持续到了第14周。</p>

<p>最开始是因为要求每个寝室出一个学生节的创意。我和徐子南在 DDL 当晚才想起这事，就在吃饭的时候和杨天龙一起开脑洞，最后想出了《电脑战争》的雏形。回去之后徐子南就赶了个剧本交了上去，没想到大受好评。最后也就确定为了我们班的节目，徐子南也就成了剧本作家。</p>

<p>我们最开始想着拍 DV，但听说今年会砍掉很多 DV，所以改成了舞台剧，不过我们还是设计了开场和结尾的两段视频。后期方面，我因为高三在电视台帮过忙，加之就在之前给校友回访剪了个片，就试着剪了开场 DV，最后就成了后期负责。当时一起负责后期的同学，加上徐子南，就成了现在鬼畜组的人。</p>

<p>学生节的准备是本学期最耗时间的工作了。第8周之前，每周的作业基本都能在第二周之前完成。开始准备学生节之后，完成作业的时间就越来越晚了，最晚的一次是 DDL 前一天晚上熬夜到3点写完的。虽是这么说，准备期间很多时间都被我们浪费掉了，经常是聊着聊着时间就过去了。印象深刻的还有两次以做后期为借口的毫无意义的熬夜。可以说学生节是浪费时间的一部血泪史。</p>

<p>好在最后效果不错，舞台效果十分出色。彩排的时候我在台下看，越看内心越激动，最后甚至有点小感动。演出结束之后好像也受到了一些好评，感觉也值了。</p>

<h2 id="小教员">小教员</h2>

<p>过完这个学期，才明白为什么有人说小教员就是个坑爹的活。</p>

<p>其实一开始我并不是小教员。我当时因为在打 ACM 网络赛，没有去参加小教员的选拔考试，徐boss 也没有把我算上。后来给徐boss 发邮件才把我加到小教员名单了，所以我说我自己是“补退选上的小教员”。</p>

<p>说实话，小教员在年级里的意义并不是很大。就我自己而言，机房值班一共就去过1次，而小教员的其他任务感觉很多是可有可无的，还有一些是赶 DDL 凑数做的，但说到底事情还是不少。</p>

<p>这个学期作为小教员干得最有意义的事情大概就是组织两次模拟考吧。最开始是黄豪硕提议要办模拟考的，大家都觉得不错，然后我就着手准备了。通过组织这两次考试，也算是体会到了举办班级活动的艰辛。</p>

<h2 id="学习方面">学习方面</h2>

<p>这学期刚开始的时候，我曾下定决心要好好学习。刚开始的一两周的确是这样，上课认真听，及时完成作业，课间还跑去提问题。可越到后面人越懒越容易懈怠，加之过了一个国庆，又过了一个 APEC，还参加了不少活动，就把学习稍微放下了。</p>

<p>而后果是很明显的。期中考试后的内容我学的明显不如期中考试前。起床困难症也犯了，有那么几次直接翘了数学课。等活动全部结束后的一月份，面对即将来临的期末考试，我也不得不认真一些，回到了接近开学两周的状态。也就是这半个月（严格来说应该是考试前一周），让我体会到了复习真的是有用的。</p>

<p>下面分科目总结一下：</p>

<h3 id="微积分">微积分</h3>

<p>花的时间最多的一科，作业厚度是其他学科作业合起来的厚度的两倍。刚开始学的时候感到各种绝望，因为我的数学水平其实并不好，很多小技巧和知识点我都不会。第二周的作业我只有1/3的会做，剩下的都是问了王赢绪才会做的。但学到后面，感觉自己的数学水平明显比以前高了，也掌握了一些小技巧。</p>

<p>期中考试的成绩并不是很理想，期末考试自我感觉不错，最后分数也还算可以吧。</p>

<h3 id="线性代数">线性代数</h3>

<p>我本以为搞竞赛时接触的一点线代知识会给我一些 advantage，后来发现学的和我会过的基本上不是一个东西……学到后面也是比较迷糊，都是靠考试前一周梳理了一遍才大概理解的。</p>

<p>两次机考因为刷了题库都拿到了满分，期末考试成绩意外地好。</p>

<h3 id="离散数学">离散数学</h3>

<p>开学的时候混了一个离散数学的课代表，其实也很轻松，收收作业就好，而且离散一学期就交4次。不过离散数学真的是离散学的，我只有开头两次和交作业的时候才去上课，知识都是交作业前和考试前学的。说实话，感觉用处就那么大，至少我们学的部分是这样的。</p>

<p>成绩和付出差不多等比例。</p>

<h3 id="程序设计基础">程序设计基础</h3>

<p>由于我是小教员，也就没有做程设的大小作业，也没有参加期末考试。现在想想，程设的确不怎么好学呢。</p>

<p>之前怕拿不到满分，还特意给徐boss 发了邮件问能不能参加期末考试。他回复我说“成绩问题不用担心”。这可能也是四年里唯一一个满分了。</p>

<h3 id="计算机科学导论">计算机科学导论</h3>

<p>这课其实不是必修，但看大家都报了就跟风报了。大概是讲本专业的基础知识吧？我也是离散学的。</p>

<p>期末考试粗心错了一个地方，没能拿到满分。</p>

<h3 id="信息科学技术概论">信息科学技术概论</h3>

<p>和别的学校的新生课差不多，就是一些教授来讲座。我只听了前两节课，觉得没什么意思。倒是课程作业让我学会了写论文的装逼技巧。</p>

<h3 id="思想道德修养与法律基础">思想道德修养与法律基础</h3>

<p>没去过几节课，不过赶上了点到。原本就听闻过帅先生的大名，本想好好上课，结果还是败给了时间。我也不知道到底学了什么，可能是帅先生的 PPT 制作技术吧。</p>

<h3 id="计算科学与生涯规划">计算科学与生涯规划</h3>

<p>说实话，这是一门很棒的课，即使是纯粹听故事也不错。很可惜，我没有珍惜这个机会，到现在才后悔莫及。期末的感想也是随便写了几百字应付一下。</p>

<p>或许等我到大四，有时间了，会再去旁听一遍吧。</p>

<h3 id="社会心理探索">社会心理探索</h3>

<p>补退选时好不容易刷上的，结果也没有珍惜。总体来说还是比较有趣的，但上课还是会困。应该是那一阵子作息都不是很规律。</p>

<p>要说真正学到了什么……可能现在已经忘光了。</p>

<h3 id="德语第二外国语1">德语(第二外国语)(1)</h3>

<p>也是补退选时抢到的。本来想学法语，结果只有德语有课余量……就选了德语。</p>

<p>这门课程给我的最大的心得就是，学外语真的需要花时间（从课时设置上就能看出来，和线代一样的课时数），而且入门时绝对不能翘课。之前自学日语的时候对于花时间没有太大感觉，但其实看动漫也是一种低效的练习。德语课我在前几周还非常积极，后来事情多了就考试翘课了，而且也从来没有背过单词。</p>

<p>幸好老师仁慈，考前划了重点（真的是重点，明确告诉了会考哪些动词和名词的变形），而且交过作业就给通过。最后在考前花了一天半突击复习，混了个优秀。但其实，我还是没法用德语说出一句完整的话。</p>

<p>还是等什么时候闲下来了，再把二外捡起来吧。</p>

<h3 id="学术英语读写3文献综述">学术英语读写（3）——文献综述</h3>

<p>这课中期被我退了。因为要点到所以每节课都去上了，但每次都会玩手机然后睡觉。可能也是我态度不端正，但真心没学到什么。</p>

<p>听说中期没退这课的人到期末都后悔了。</p>

<h3 id="学术英语听说4辩论">学术英语听说（4）——辩论</h3>

<p>就是因为上了这课才被拉进辩论队。一学期下来在课堂上辩论了两次，讲的其实很一般。印象深刻的是我的第二次辩论，论题是“软性毒品是否应该被合法化”。按立场来说我肯定属于反方，但反方没位置了，只好加入正方。结果整场辩论下来，局势竟然倾向于我们这一方。虽然自己讲的不好，但还是有成就感的。</p>

<p>不过这课没有期末考核，一切看平时成绩，也没有治疗的余地。</p>

<h3 id="实验室科研探究">实验室科研探究</h3>

<p>看这课是一门文核就选了，也有学长告诉我这课好。但我选的比较晚，有趣的实验室都被抢光了。我去的8个实验室中，只有一个有实际的体验，只有另外两个我觉得是有趣或者真的学到了东西。</p>

<p>最蛋疼的是，这课有时会和班上的活动冲突，感觉有点得不偿失。</p>

<h2 id="后记">后记</h2>

<p>写完发现自己还是写了流水账。但其实还有很多事情没有写，比如第一次献血，看校歌赛，参加素拓，看话剧和音乐会，和新生引导老师谈话等。想来想去，还是只写了最重要的几件事。最后学习方面有点啰嗦，不过也算是自己的真实感受。</p>

<p>这个学期也就这么结束了。一学期的事情比过去几年加起来还要多。用一句话来总结的话，大概就是，忙却充实吧。</p>

<h2 id="展望">展望</h2>

<p>差点忘了这个部分。</p>

<p>下学期的目标，分几个方面来叙述吧。</p>

<p>首先是学习。这个学期的成绩还是很满意的，可以说是在意料之外。希望下个学期可以保持。下个学期的课和活动（应该）比这个学期少（吧），感觉还是有希望的。</p>

<p>接下来是社工和活动。不知道下个学期是不是可以加入学生会了，如果可以的话我想尝试一下，加入文艺部或者科协。这个学期根本没有参加社团活动，虽然我加入的社团也基本上很少有活动，下个学期准备至少去几次。班级活动还是会像这个学期一样积极参加，因为的确很有意思，而且能让自己收获一些东西。</p>

<p>然后是体育。这个学期虽说在体质上有增强，但体育成绩还是很难看的。下个学期准备约人一起去健身房，平时也要加强锻炼，不能像这个学期下半学期一样除了阳光刷卡之外什么都不搞。</p>

<p>其他的话，希望能学一些技术之类的。也听说下学期还有实习机会，如果事情不多的话还是想尝试一下。</p>

<p>这么一写下来，下学期事情还是挺多的……只希望不要荒废。</p>

  </div>

  <footer class="post-footer">
    <div class="post-meta">
       <time datetime="2015-02-06T02:00:00+00:00" itemprop="datePublished">Feb 6, 2015</time> 
      
    </div>

    
  </footer>

  
  <div id="disqus_thread"></div>
<script>
  var disqus_config = function () {
    this.page.url = 'http://zecong.hu/2015/02/06/my-1st-semester-in-college/';
    this.page.identifier = 'http://zecong.hu/2015/02/06/my-1st-semester-in-college/';
  };

  (function() {
    var d = document, s = d.createElement('script');

    s.src = 'https://huzecong-blog.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  
</article>

    </div>
    <script type="text/javascript">
  (function () {
    var resize = function () {
      this.width = 0.5 * (this.naturalWidth || this.width);
    }
    Array.prototype.forEach.call(document.querySelectorAll(".half-size, .retina2x"), function(el) {
      if (el.naturalWidth) {
        resize.call(el);
      } else {
        el.onload = resize;
      }
    });
  })();
</script>

  </main>

  
<script type="text/javascript">
  // Show tooltips for footnotes.
  (function() {
    const footnotes = document.querySelectorAll(".footnotes > ol > li");
    const returnMarkRegex = /("?&nbsp;<a href="#fnref:.+?" class="reversefootnote">↩(<sup>.*?<\/sup>)*<\/a>)+/s;
    const footnoteMarks = document.querySelectorAll("a.footnote");
    for (let index of footnoteMarks.keys()) {
      if (footnotes[index] === undefined) continue;
      const content = footnotes[index].innerHTML.replace(returnMarkRegex, "");
      const footnote = footnoteMarks[index];
      tippy(footnote, {
        content: content,
        arrow: true,
        animation: 'shift-away',
        interactive: true,
        theme: 'light',
        // trigger: 'click',
        size: 'large',
        touch: false,
        touchHold: true,
      });
    }
  })();
</script>



<script type="text/javascript">
  // Add "active" highlight to TOC on left.
  // Credit: https://codemyui.com/sidebar-menu-scroll-progress-indicator/
  (function() {
    const svg_html = ' \
      <svg class="toc-marker" width="200" height="200" \
           xmlns="http://www.w3.org/2000/svg"> \
        <path stroke="#444" stroke-width="1.5" fill="transparent" \
              stroke-dasharray="0, 0, 0, 1000" stroke-linecap="round" \
              stroke-linejoin="round" transform="translate(-0.5, -0.5)" /> \
      </svg> \
      '
    document.querySelector("#table-of-contents .toc-wrapper").innerHTML += svg_html;
  })();

  // Jekyll renders everything on one level, so nested titles are not actuall
  // nested in the DOM. We need to manually create the levels.
  const contentElems = document.querySelector("article > div.post-content").children;
  // A `tocItem` is a dictionary.
  const tocItems = [].slice
    .call(document.querySelectorAll("#table-of-contents li.toc-entry"))
    .map(function(item) {
      const anchor = item.querySelector("a");
      const subList = item.querySelector("ul");
      return {
        item: item,
        href: anchor.getAttribute("href").substr(1),  // remove '#' prefix
        anchor: anchor,
        subList: subList,
      };
    });
  let tocPointer = 0;
  const validTags = ["H1", "H2", "H3", "H4", "H5", "H6"];
  for (let index = 0; index < contentElems.length; ++index) {
    const elem = contentElems[index];
    if (validTags.indexOf(elem.tagName) !== -1) {
      const level = parseInt(elem.tagName[1]);

      if (tocPointer > 0 && tocPointer <= tocItems.length) {
        tocItems[tocPointer - 1].targetBottom = contentElems[index - 1];
      }

      // Current element matches the next entry in the TOC.
      if (tocPointer < tocItems.length &&
          elem.id === tocItems[tocPointer].href) {
        const curTocItem = tocItems[tocPointer];
        curTocItem.level = level;
        curTocItem.titleElem = elem;
        ++tocPointer;
      }
    }
  }
  // Final TOC items has not yet ended.
  if (tocPointer > 0 && tocPointer <= tocItems.length) {
    tocItems[tocPointer - 1].targetBottom = contentElems[contentElems.length - 1];
  }

  let pathLength;

  const tocPath = document.querySelector('.toc-marker path');

  function drawPath() {
    const path = [];
    let pathIndent,
        topOffset = 0;

    // pathLength = 100000;
    // setActivePath(currentActiveIndex);

    tocItems.forEach(function(item) {
      const x = item.anchor.offsetLeft - 5,
            height = item.anchor.offsetHeight;
      const y = topOffset;

      const parent = item.item.parentNode;
      
      if (!(parent.classList.contains("section-nav") ||
            parent.parentNode.classList.contains("expand"))) {
        // Top-level section.
        item.pathStart = 0;
        item.pathEnd = 0;
        return;
      }

      if (path.length === 0) {
        path.push( 'M', x, y, 'L', x, y + height );
        item.pathStart = 0;
      } else {
        // Draw an additional line when there's a change in
        // indent levels.
        if (pathIndent !== x) path.push('L', pathIndent, y);
        path.push('L', x, y);

        // Set the current path so that we can measure it.
        tocPath.setAttribute('d', path.join(' '));
        item.pathStart = tocPath.getTotalLength() || 0;

        path.push('L', x, y + height);
      }
      topOffset += height;

      pathIndent = x;
      tocPath.setAttribute('d', path.join(' '));
      item.pathEnd = tocPath.getTotalLength();
    });

    pathLength = tocPath.getTotalLength();
  }

  let currentActiveIndex = null;

  function setActivePath(index) {
    // Specify the visible path or hide the path altogether
    // if there are no visible items.
    if (index !== null) {
      const pathStart = tocItems[index].pathStart;
      const pathEnd = tocItems[index].pathEnd;
      if (pathEnd === 0) {
        // no-op
      } else {
        tocPath.setAttribute('stroke-dashoffset', '1');
        // Set dash end to an infinitely large value to avoid
        // accidental repetition of pattern.
        tocPath.setAttribute(
          'stroke-dasharray',
          '1, ' + pathStart + ', '+ (pathEnd - pathStart) + ', ' + 10000000);
        tocPath.setAttribute('opacity', 1);
      }
      // console.log(index, tocItems[index].href, pathStart, pathEnd, pathLength);
    } else {
      tocPath.setAttribute('opacity', 0);
    }
  }

  function setActiveEntryClass(index, className) {
    // Set CSS classes for the current index and ancestors.
    const isActive = Array(tocItems.length).fill(false);
    // Compute heights of each item after expanding here, because `scrollHeight`
    // does not take into account inner height of nested non-expanded lists that
    // will also be expanded next.
    const expandedHeights = Array(tocItems.length).fill(0);

    if (index !== null) {
      let item = tocItems[index];
      let curLevel = Infinity;
      let accumulateHeight = 0;
      for (let i = index; i >= 0; --i) {
        item = tocItems[i];
        if (item.level < curLevel) {
          curLevel = item.level;
          if (item.subList !== null)
            accumulateHeight += item.subList.scrollHeight;
          expandedHeights[i] = accumulateHeight;
          isActive[i] = true;
        }
      }
    }

    const itemsToAdd = [], itemsToRemove = [];
    const addHeights = [];
    for (let i = 0; i < tocItems.length; ++i) {
      const item = tocItems[i];
      if (item.item.classList.contains(className)) {
        if (!isActive[i]) {
          item.item.classList.remove(className);
          if (item.subList !== null) {
            itemsToRemove.push(item.subList);
          }
        }
      } else {
        if (isActive[i]) {
          item.item.classList.add(className);
          if (item.subList !== null) {
            itemsToAdd.push(item.subList);
            addHeights.push(expandedHeights[i]);
          }
        }
      }
    }

    return {
      add: itemsToAdd,
      addHeights: addHeights,
      remove: itemsToRemove,
    };
  }

  function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  // Ticket-based queue.
  let transitionTicket = 0, transitionCounter = 0;

  // Credit: https://css-tricks.com/using-css-transitions-auto-dimensions/
  async function toggleItems() {

    // Empty loop waiting for ticket.
    const ticket = transitionCounter++;
    while (ticket !== transitionTicket) {
      await sleep(100);
    }

    // if (ticket + 1 !== transitionCounter) {
    //   transitionTicket = ticket + 1;
    //   return;
    // }

    // Use the latest active index.
    const index = currentActiveIndex;
    itemChanges = setActiveEntryClass(index, "expand");

    if (itemChanges.add.length === 0 && itemChanges.remove.length === 0) {
      // if (ticket + 1 === transitionCounter) {
        // Only perform callback on final ticket.
        // drawPath();
        setActivePath(index);
      // }
      // Null transition, release ticket.
      transitionTicket = ticket + 1;
      return;
    }

    const firstItem = (itemChanges.add.length > 0 ?
                       itemChanges.add[0] : itemChanges.remove[0]);
    const originalTransition = firstItem.style.transition;
    const allItems = itemChanges.add.concat(itemChanges.remove);

    const targetHeight = itemChanges.addHeights;
    allItems.forEach(item => item.style.transition = "");
    for (let item of itemChanges.add) {
      item.style.height = "0";
    }
    for (let item of itemChanges.remove) {
      item.style.height = item.scrollHeight + "px";
    }
    firstItem.offsetHeight;  // trigger reflow

    requestAnimationFrame(function() {
      for (let i = 0; i < itemChanges.add.length; ++i) {
        const item = itemChanges.add[i];
        item.style.height = targetHeight[i] + "px";
      }
      for (let i = 0; i < itemChanges.remove.length; ++i) {
        const item = itemChanges.remove[i];
        item.style.height = "0";
      }
      allItems.forEach(item => item.style.transition = originalTransition);
      firstItem.offsetHeight;  // trigger reflow

      firstItem.addEventListener('transitionend', function(e) {
        // Event listeners are also fired for children nodes.
        if (e.target !== firstItem) return;
        e.target.removeEventListener(e.type, arguments.callee);
        for (let item of itemChanges.add) {
          item.style.height = "auto";
        }
        for (let item of itemChanges.remove) {
          item.style.height = null;
        }
        firstItem.offsetHeight;  // trigger reflow

        // End of transition, release ticket.
        transitionTicket = ticket + 1;
      });

      drawPath();
      setActivePath(index);
    });
  }

  function updateActive(event, forceRedraw = false) {
    const windowHeight = window.innerHeight;

    // We only allow one entry to be active. This entry must satisfy one of the
    // following conditions:
    // 1. Its section is the only section visible on screen.
    // 2. Its title (`targetTop`) is the first title that is within screen bounds.
    const titlePos = tocItems.map(function(item) {
      return item.titleElem.getBoundingClientRect();
    });
    const targetBottom = tocItems.map(function(item) {
      return item.targetBottom.getBoundingClientRect().bottom;
    });

    let index = 0;
    for (; index < tocItems.length; ++index) {
      if (// Any portion of title is within screen bounds.
          (0 < titlePos[index].bottom && titlePos[index].top < windowHeight) ||
          // Section is the only one on screen...
          (titlePos[index].top < 0 &&
            // ... and is the final section.
           ((index === tocItems.length - 1 &&
             targetBottom[index] > 0) ||
            // ... and the next section title is not completely shown.
            (index < tocItems.length - 1 &&
             titlePos[index + 1].bottom > windowHeight)))) {
        break;
      }
    }
    if (index >= tocItems.length) index = null;

    if (currentActiveIndex !== index || forceRedraw) {
      // console.log("redraw", currentActiveIndex, index, forceRedraw);
      currentActiveIndex = index;

      // setActivePath(index);
      setActiveEntryClass(index, "active");

      requestAnimationFrame(function() {
        toggleItems();
      });
    }
  }

  drawPath();
  updateActive(true);
  window.addEventListener('resize', function(event) {
    updateActive(event, true);
  }, false);
  window.addEventListener('scroll', updateActive, false);
</script>


<footer class="site-footer">

  <div class="wrapper">
    <div class="social-links">
      
      <a class="social-link social-github" href="https://github.com/huzecong">
        <i class="icon-github"></i>
      </a>
      
      
      
      <a class="social-link social-rss" href="/feed.xml" target="_blank">
        <i class="icon-rss"></i>
      </a>
    </div>
    <div class="credits">
      KAGAMI, made with <i class="icon-heart"></i> by Kamikat
    </div>
  </div>

</footer>


</body>

</html>
